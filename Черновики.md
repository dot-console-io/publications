---
sticker: emoji//1f479
---
## Валидаторы и справочники

Когда данные с формы заказа попадают в ордер-сервис должна происходить из валидация

## ФинОпс

Сбер выпустил не плохую эксельку описывающие все аспекты подхода finOps. Но предполагается что, нужно проанализировать апихи зарубежных облаков и посмотреть какие решения по использованию данных есть на рынке. Полюбому можно найти opensource для базового finops и посмтреть как работает. Но из фаворитов пока конечно же Azure

![[Cloud_ru_%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_FinOps_%D0%B2_%D0%BE%D1%80%D0%B3%D0%B0%D0%BD%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D0%B8.xlsx]]

Тут стоит подумать еще как считать это потребление

Или складывать время жизни каждого ресурса или просто по таймеру каждую минуту инкрементировать стоимость затрат

## Сервис-дискавери

Идея родилась из сообщения про rpc-jira в рабочем чате. Интересно то что методов работы с джирой уж очень прям много и пожтому логично, что на подобные модули появлялись бы внешние поставщики своих решений, а для этого нужно упростить установку и настройку модулей. Если сейчас посмотреть, то установка происходит по следующим этапам:

- Создание очередей
- Деплой модуля
- Добавление шаблонов в админке

  

Было бы интересно если сервисы сами могли получать и создавать большинство объектов. Например, регаешь новую rpc где-то и при деплое просто указываешь уз. Модуль сам получает какие очереди использовать и создает шаблоны

  

Тогда мы тут приходим к аналогу keystone где регистрируются сервисы

  

## Аудит

Как поставлять события из внешних систем, что кто-то что-то сделал и типы событий

Так же туда оповещение о событиях. В событиях еще можно сделать настраиваемое условие, чтобы они могли гибко настраивать алертинг, хотя не понятно как дать полный набор инструментов. Предположим есть в аудите адрес откуда заходил пользователь - явной проверки региона нет, а реализовывать полный набор функций для всех кейсов нет возможности. Если конечно давать писать питоновский код, но как его запускать и где не понятно. Или взять вебхуками просто например реализовать, но придут и скажут, что нужно вебхуки в приватную инфру. Хотя если запилить что будет запускаться контейнер в их приватной сети, то еще норм, но нужно натягивать sdn и на кубер

  

## Авторизация

Тут нудно будет пилить мультиреалм, так как все хотят интеграцию со своим sso и настраиваемую политику паролей. Использую подход как в т1 запилить это дико сложно, но тогда как делать проверку токена из разных реалмов в сервисах.

  

## Паблик или приват?

Вот как это делать? В приватных облаках нужен нормальный ipam, а в паблике все сети изолированные. Тут даже на уровне поля ввода. Пользак вводит свою сеть или выбирает из списка на выбор приватные. Плюс в привате хорошо было бы если админы могли настраивать сеть прям в облаке и указывать конфиги. Тут получается компьют такой же продукт, причем который будет отличаться от паблика

  

## Перечень сервисов Managment

тут стоит резделять компоненты облака и сервисов для пользователя. Например из компонентов может быть оркестратор, сервис состояний и прочее, а вот в служебных сервисах будет:

- Iam
- Audit
- Billing

  

## Marketplace

Как его класифицировать? Не служебный сервис точно. Может быть отнести его к шаблонам?

  

## Разделить сущность

Все-таки заказы и ресурсы в одном месте очень уж не удобно ввиду того, что статус заказа и сущностей разделены и отслеживать и фильтровать это очень не удобно

  

Следовательно можно сделать как в azure, что при заказе сервиса создается именно заказ и в нем написано какие ресурсы создались. Только минус в том, что в azure нельзя потом найти список заказов и посмотреть откуда был создан ресурс

  

## Гибридная инсталяция

Как подключать гипервизоры внешние?

  

## Нотификация

Выносить ли центр нотификации отдельно? Наверное да

Основной функционал будет таковым

- Нотификация пользователей
- Нотификация о релизах в углу экрана
- Настройки нотификации пользователей
- Алерты
- Настраиваемый алертинг как в AWX

Было бы прикольно реализовать его в виде отдельного пунка в админке где пользователь может сам управлять своими уведомлениями и админы управлять уведомлениями пользователей (нужно ли запрещать пользователям управлять уведомлениями?)

[[Под капотом облаков. Строим облачную консоль. Часть 1. Знакомство]]

  

## Сервис заказов

В любом случае нужно будет делать полностью ассинхронный. В оредере должен быть этап валидации заказа, чтобы была возможность навесить всякие политики и проверку лимитов.

Соотвественно из функционала ордер сервиса получается следующее

- Прием заказов (вообще можем принимать любую json и отдавать id)
- Валидация (тут нужно сделать гибки и масштабирован

Далее идет оркестратор

[[Под капотом облаков. Строим облачную консоль. Часть первая. Сервис заказов]]

  

## API Clouds

- Azure - [https://learn.microsoft.com/en-us/rest/api/aks/managed-clusters/create-or-update?view=rest-aks-2024-05-01&tabs=HTTP](https://learn.microsoft.com/en-us/rest/api/aks/managed-clusters/create-or-update?view=rest-aks-2024-05-01&tabs=HTTP)
- GCP - [https://cloud.google.com/compute/docs/reference/rest/v1](https://cloud.google.com/compute/docs/reference/rest/v1)
- DigitalOcean - [DigitalOcean API Docs :: DigitalOcean Documentation](https://docs.digitalocean.com/reference/api/api-reference/)
- Alibaba - [Elastic Compute Service_Home Page - Alibaba Cloud OpenAPI Portal (aliyun.com)](https://api.aliyun.com/product/Ecs?tab=apis)

  

- Yandex - [https://yandex.cloud/ru/docs/overview/api](https://yandex.cloud/ru/docs/overview/api)
- Cloud - [Обзор возможностей — документация API Cloud.ru](https://cloud.ru/docs/console_api/ug/index.html)
- Selectel - [Cloud Management • Документация к API (selectel.ru)](https://developers.selectel.ru/docs/selectel-cloud-platform/main-services/selectel_cloud_management_api/)